import{s as u,C as g,r as f,D as h,j as s}from"./index-cdebceRY.js";import{u as x,N as S,P as w,T as n}from"./use-form-DQOe5fi8.js";import{C as P}from"./Container-DWDiUS4r.js";import{L as j}from"./LoadingOverlay-DnUb__om.js";import{G as b}from"./Group-DPDd8gIt.js";import{B as y}from"./Button-CR_b25QF.js";import"./polymorphic-factory-BlvI53Kh.js";import"./Transition-C01W1Flp.js";const k=()=>{const o=u(),[i,{isLoading:t}]=g(),[l,r]=f.useState(null);return{handleSignup:async e=>{try{const a=await i(e).unwrap();console.log("From handle signup hook the result: ",a),r({color:"green",message:"Signup successful!"});const{token:c,username:d,email:p}=a;document.cookie=`token=${c}; path=/; msax-age=${60*60*24}; SameSite=Strict; Secure`,console.log("cookie: ",document.cookie),o(h({username:d,email:p}))}catch(a){console.log(a),r({color:"red",message:"Signup failed!"})}},notification:l,setNotification:r,isLoading:t}},M=()=>{const o=x({initialValues:{username:"",email:"",password:"",confirmPassword:""},validate:{email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email",confirmPassword:(e,a)=>e!==a.password?"Passwords did not match":null}}),{handleSignup:i,notification:t,setNotification:l,isLoading:r}=k(),m=async e=>{console.log(e),i(e),o.reset()};return s.jsxs(P,{m:"md",children:[s.jsx(j,{visible:r,loaderProps:{size:"lg",color:"blue"}}),t&&s.jsx(S,{color:t.color,onClose:()=>l(null),children:t.message}),s.jsx(w,{bd:"1px solid blue.8",p:"lg",radius:"sm",children:s.jsxs("form",{onSubmit:o.onSubmit(m),children:[s.jsx(n,{mt:"md",label:"Username",placeholder:"Username",...o.getInputProps("username")}),s.jsx(n,{mt:"md",label:"Email",placeholder:"Email",...o.getInputProps("email")}),s.jsx(n,{mt:"md",label:"Password",placeholder:"Password",type:"password",...o.getInputProps("password")}),s.jsx(n,{mt:"md",label:"Confirm Password",placeholder:"Confirm Password",type:"password",...o.getInputProps("confirmPassword")}),s.jsx(b,{justify:"center",mt:"xl",children:s.jsx(y,{type:"submit",loading:r,children:"Sign Up"})})]})})]})};export{M as default};
